{"version":3,"file":"wrapApiHandlerWithSentry.js","sources":["../../../src/edge/wrapApiHandlerWithSentry.ts"],"sourcesContent":["import { getCurrentHub } from '@sentry/core';\n\nimport type { EdgeRouteHandler } from './types';\nimport { withEdgeWrapping } from './utils/edgeWrapperUtils';\n\n/**\n * Wraps a Next.js edge route handler with Sentry error and performance instrumentation.\n */\nexport function wrapApiHandlerWithSentry<H extends EdgeRouteHandler>(\n  handler: H,\n  parameterizedRoute: string,\n): (...params: Parameters<H>) => Promise<ReturnType<H>> {\n  return new Proxy(handler, {\n    apply: (wrappingTarget, thisArg, args: Parameters<H>) => {\n      const req = args[0];\n\n      const activeSpan = getCurrentHub().getScope().getSpan();\n\n      const wrappedHandler = withEdgeWrapping(wrappingTarget, {\n        spanDescription:\n          activeSpan || !(req instanceof Request)\n            ? `handler (${parameterizedRoute})`\n            : `${req.method} ${parameterizedRoute}`,\n        spanOp: activeSpan ? 'function' : 'http.server',\n        mechanismFunctionName: 'wrapApiHandlerWithSentry',\n      });\n\n      return wrappedHandler.apply(thisArg, args);\n    },\n  });\n}\n\n/**\n * @deprecated Use `wrapApiHandlerWithSentry` instead.\n */\nexport const withSentryAPI = wrapApiHandlerWithSentry;\n"],"names":[],"mappings":";;;AAKA;AACA;AACA;AACA,SAAA,wBAAA;AACA,EAAA,OAAA;AACA,EAAA,kBAAA;AACA,EAAA;AACA,EAAA,OAAA,IAAA,KAAA,CAAA,OAAA,EAAA;AACA,IAAA,KAAA,EAAA,CAAA,cAAA,EAAA,OAAA,EAAA,IAAA,KAAA;AACA,MAAA,MAAA,GAAA,GAAA,IAAA,CAAA,CAAA,CAAA,CAAA;AACA;AACA,MAAA,MAAA,UAAA,GAAA,aAAA,EAAA,CAAA,QAAA,EAAA,CAAA,OAAA,EAAA,CAAA;AACA;AACA,MAAA,MAAA,cAAA,GAAA,gBAAA,CAAA,cAAA,EAAA;AACA,QAAA,eAAA;AACA,UAAA,UAAA,IAAA,EAAA,GAAA,YAAA,OAAA,CAAA;AACA,cAAA,CAAA,SAAA,EAAA,kBAAA,CAAA,CAAA,CAAA;AACA,cAAA,CAAA,EAAA,GAAA,CAAA,MAAA,CAAA,CAAA,EAAA,kBAAA,CAAA,CAAA;AACA,QAAA,MAAA,EAAA,UAAA,GAAA,UAAA,GAAA,aAAA;AACA,QAAA,qBAAA,EAAA,0BAAA;AACA,OAAA,CAAA,CAAA;AACA;AACA,MAAA,OAAA,cAAA,CAAA,KAAA,CAAA,OAAA,EAAA,IAAA,CAAA,CAAA;AACA,KAAA;AACA,GAAA,CAAA,CAAA;AACA,CAAA;AACA;AACA;AACA;AACA;AACA,MAAA,aAAA,GAAA;;;;"}